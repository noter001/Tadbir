<!DOCTYPE html>
<html>
<head>
  <title>tadbir_service</title>
  <script>
    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          function(position) {
            document.getElementById("location").value = 
              position.coords.latitude + ", " + position.coords.longitude;
          },
          function(error) {
            alert("خطأ في تحديد الموقع: " + error.message);
          }
        );
      } else {
        alert("المتصفح لا يدعم تحديد الموقع الجغرافي.");
      }
    }

    function sendData(event) {
      event.preventDefault(); // منع إعادة تحميل الصفحة

      let name = document.getElementById("name").value.trim();
      let phone = document.getElementById("phone").value.trim();
      let address = document.getElementById("address").value.trim();
      let order = document.getElementById("order").value.trim();
      let location = document.getElementById("location").value.trim();

      // التحقق من القيم الفارغة قبل الإرسال
      if (!name || !phone || !address || !order || !location) {
        alert("المرجو ملء جميع الحقول قبل الإرسال!");
        return;
      }

      var formData = {
        name: name,
        phone: phone,
        address: address,
        order: order,
        location: location
      };

      fetch("https://young-unit-315a.noter001.workers.dev/", {
        method: "POST",
        body: JSON.stringify(formData),
        headers: { "Content-Type": "application/json" }
      })
      .then(response => response.json()) // تحويل الرد إلى JSON
      .then(data => {
        if (data.status === "success") {
          alert(data.message);
          document.getElementById("form").reset(); // تفريغ الحقول بعد الإرسال
        } else {
          alert("خطأ: " + data.message);
        }
      })
      .catch(error => alert("حدث خطأ أثناء الإرسال: " + error));
    }
  </script>
</head>
<body>
  <h2>tadbir_service</h2>
  <form id="form">
    <label>name:</label>
    <input type="text" id="name" required><br><br>

    <label>phone:</label>
    <input type="text" id="phone" required><br><br>

    <label>address:</label>
    <input type="text" id="address" required><br><br>

    <label>order:</label>
    <select id="order">
      <option value="">اختر منتجًا</option>
      <option value="منتج 1">منتج 1</option>
      <option value="منتج 2">منتج 2</option>
      <option value="منتج 3">منتج 3</option>
    </select><br><br>

    <label>location:</label>
    <input type="text" id="location" readonly>
    <button type="button" onclick="getLocation()">Ma Position</button><br><br>

    <button type="submit" onclick="sendData(event)">إرسال</button>
  </form>
</body>
</html>
